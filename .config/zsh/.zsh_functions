#!/usr/bin/env zsh

function cf() {
    rg --files ~/.config --type zshrc --type sh --type vim | fzf | xargs -r "$EDITOR" 
}

function sf() {
    rg --files "/repo/$USER/scripts" ~/.scripts --type sh --type py | fzf | tr -d '\n' | xclip -selection clipboard 
}

function ff() { 
    rg --vimgrep "$0" | fzf 
}

     
# find-in-file - usage: fif <SEARCH_TERM>
function fif() {
    [ ! "$#" -gt 0 ] && echo "No arguments!!" && return 1
    rg "$1" "$2" --vimgrep --color ansi | fzf --ansi \
        --preview "rg --smart-case --pretty --context 10 '$1' {}"
}

function mlf () {
    [ ! "$#" -gt 0 ] && echo "No arguments!!" && return 1
    module --color=auto avail "$1" | fzf 
}

function cpr() {
  rsync --archive -hh --partial --info=stats1 --info=progress2 --modify-window=1 "$@"
} 

function mvr() {
  rsync --archive -hh --partial --info=stats1 --info=progress2 --modify-window=1 --remove-source-files "$@"
}

function pprint () {
    [ -z "$1" ] && echo "invalid argument" && return 1
    echo "$1" | sed -e 's/\:/\n/g' | fzf 
}

function _brew_lazy_load () {
    # if [ -x "$HOMEBREW_PREFIX/bin/brew" ]; then
    eval "$("$HOMEBREW_PREFIX/bin/brew" shellenv)"
    # fi
}

# HISTSIZE is somehow getting reset
function _rhel_env_reset() {
    export HISTSIZE=10000
    _brew_lazy_load 
    module restore batteries_included
}

function _lc_rec () {
    export LANGUAGE=en_US.UTF-8
    export LANG=en_US.UTF-8
    export LC_ALL=en_US.UTF-8
}

function _prep_dev_env() { 
    source "$DEV_SDK" 
    unset PYTHONHOME 
    export CONF_SDK_FLAGS='--target=arm-wrs-linux-gnueabi --host=arm-wrs-linux-gnueabi --build=x86_64-linux --with-libtool-sysroot=$SDKTARGETSYSROOT'
}

function _prep_default_env() { 
    source /proj/bidaas1/installed_sdk/air6449-nr-applic-2/environment-setup-armv7a-vfp-neon-wrs-linux-gnueabi
    unset PYTHONHOME 
}

function _prep_vscode_env() {
    _prep_default_env
    _lc_rec
    module source ~/.config/modules/vscode_minimal
}
